## ğŸ› ï¸Â Prompt for Replit AIÂ â€”Â Enable Reliable â€œAddÂ toÂ HomeÂ Screenâ€ on our PWA

### 1. Goal
Make sure the existing codebase meets *all* installâ€‘ability requirements so every modern mobile browser shows our â€œAddÂ toÂ HomeÂ Screen / Installâ€ prompt.

### 2. Scope of work  
Work only in the frontâ€‘end project (React/Vite).  
Do **not** alter backâ€‘end routes, DB migrations, or CI workflows unless explicitly stated below.

### 3. Tasks & Checks

#### 3.1 Webâ€‘App Manifest  
1. Find **`public/manifest.json`** (or its equivalent).  
2. Verify it contains at minimum:  
   - `"name"` and `"short_name"`.  
   - `"start_url": "."` (relative URL).  
   - `"display": "standalone"` (or `"minimal-ui"`).  
   - Icons: `192Ã—192` **and** `512Ã—512` PNGs with `"purpose": "any"` or `"maskable any"`.  
3. Confirm `<link rel="manifest" â€¦>` is present in the root HTML template.  
4. If missing icons, create placeholder PNGs with a solid background matching the design system colour and place them in `public/icons/`. Add correct paths to the manifest.

#### 3.2 Service Worker  
1. Locate existing SW registration (e.g., `src/swRegistration.ts` or `index.tsx`).  
2. Ensure `navigator.serviceWorker.register('/sw.js')` runs **only once** after `window.load`, wrapped in a featureâ€‘detection guard.  
3. Open **`public/sw.js`** (or equivalent):  
   - Confirm there is at least one `fetch` listener returning a networkâ€‘first or cacheâ€‘first response.  
   - Add an **offline fallback** (`/offline.html`) if none exists.  
4. Make sure Build tooling copies the SW and manifest into the final `dist/` folder.

#### 3.3 â€œbeforeinstallpromptâ€ integration  
1. Create/verify a React hook (`usePWAInstall`) or simple module bound at `App` level:  
   - Listen for `beforeinstallprompt`, call `e.preventDefault()`, store the event in state.  
   - Expose a method `triggerInstall()` that calls `deferredPrompt.prompt(); deferredPrompt.userChoice â€¦`.  
2. Inject a small floating **Install** button (e.g., `components/InstallFAB.tsx`) that:  
   - Only appears when the saved event exists.  
   - Hides after successful install or dismissal.  
   - Is keyboard accessible and ariaâ€‘labelled.

#### 3.4 iOS / Safari fallback  
1. Add meta tags to `index.html` head section:  

   ```html
   <meta name="apple-mobile-web-app-capable" content="yes" />
   <meta name="apple-mobile-web-app-status-bar-style" content="default" />
   <link rel="apple-touch-icon" href="/icons/192.png" />
Detect window.navigator.standalone === false and iOS UA; display a nonâ€‘intrusive banner guiding the user:
â€œTapâ€¯â€¯Shareâ€¯â€¯â†’â€¯â€¯Addâ€¯toâ€¯Homeâ€¯Screenâ€.

3.5 Regressionâ€‘safe refactor
Keep all existing imports, bundler aliases, and global styles intact.

Any new file must use the projectâ€™s lint/prettier rules (run npm run lint:fix).

Write changes in TypeScript if the repo already uses .tsx; otherwise stay in plain JS.

Wrap all new logic in clear, selfâ€‘contained components or utilities to minimise diff size.

